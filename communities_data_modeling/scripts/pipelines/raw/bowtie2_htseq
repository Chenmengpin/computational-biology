#!/bin/sh
#
#SBATCH --job-name=bbsplit_bbmap
#SBATCH --time=1000:00
#SBATCH --nodes=4
#SBATCH --ntasks=1

# use bbmap to align bbsplit reads output
# htseq count
# gff files generated by PATRIC
# assemblies generated by SPades and plasmid SPades

cd /data/dragon/mohameam/RNAseq/
module load bowtie2 compilers-extra oracle-java/1.8.0.31 gcc perl
export PATH=/data/dragon/mohameam/asoft/bbmap/:$PATH
export PATH=/data/dragon/mohameam/asfot/HTSeq-0.6.1/:$PATH

bowtie2 -fr -x VCH -q -1 S_16_F0203_22-V52_Replicate-1_E-coli-Vibrio_S22_L004_R1_001_val_1.fq.gz -2 S_16_F0203_22-V52_Replicate-1_E-coli-Vibrio_S22_L004_R2_001_val_2.fq.gz -S vch_rep_1.sam
bowtie2 -fr -x VCH -q -1 S_16_F0204_23-V52_Replicate-2_E-coli-Vibrio_S23_L004_R1_001_val_1.fq.gz -2 S_16_F0204_23-V52_Replicate-2_E-coli-Vibrio_S23_L004_R2_001_val_2.fq.gz -S vch_rep_2.sam
bowtie2 -fr -x VCH -q -1 S_16_F0205_24-V52_Replicate-3_E-coli-Vibrio_S24_L004_R1_001_val_1.fq.gz -2 S_16_F0205_24-V52_Replicate-3_E-coli-Vibrio_S24_L004_R2_001_val_2.fq.gz -S vch_rep_3.sam

python htseq-count -f sam -s yes  -t CDS -i ID vch_rep_1.sam VCH_PATRIC.gff > vch_rep_1_counts
python htseq-count -f sam -s yes  -t CDS -i ID vch_rep_2.sam VCH_PATRIC.gff > vch_rep_2_counts
python htseq-count -f sam -s yes  -t CDS -i ID vch_rep_3.sam VCH_PATRIC.gff > vch_rep_3_counts

bowtie2 -fr -x E36 -q -1 S_16_F0206_25-E36_Replicate-1_E-coli-Vibrio_S25_L004_R1_001_val_1.fq.gz -2 S_16_F0206_25-E36_Replicate-1_E-coli-Vibrio_S25_L004_R2_001_val_2.fq.gz -S e36_rep_1.sam
bowtie2 -fr -x E36 -q -1 S_16_F0207_26-E36_Replicate-2_E-coli-Vibrio_S26_L004_R1_001_val_1.fq.gz -2 S_16_F0207_26-E36_Replicate-2_E-coli-Vibrio_S26_L004_R2_001_val_2.fq.gz -S e36_rep_2.sam
bowtie2 -fr -x E36 -q -1 S_16_F0208_27-E36_Replicate-3_E-coli-Vibrio_S27_L004_R1_001_val_1.fq.gz -2 S_16_F0208_27-E36_Replicate-3_E-coli-Vibrio_S27_L004_R2_001_val_2.fq.gz -S e36_rep_3.sam

python htseq-count -f sam -s yes  -t CDS -i ID e36_rep_1.sam E36_PATRIC.gff > e36_rep_1_counts
python htseq-count -f sam -s yes  -t CDS -i ID e36_rep_2.sam E36_PATRIC.gff > e36_rep_2_counts
python htseq-count -f sam -s yes  -t CDS -i ID e36_rep_3.sam E36_PATRIC.gff > e36_rep_3_counts

bowtie2 -fr -x VCH -q -1 S_16_F0212_31-V52-plus-E36_Replicate-1_E-coli-Vibrio_S31_L004_R1_001_val_1.fq.gz -2 S_16_F0212_31-V52-plus-E36_Replicate-1_E-coli-Vibrio_S31_L004_R2_001_val_2.fq.gz -S vch_and_e36_VCH_rep_1.sam
bowtie2 -fr -x VCH -q -1 S_16_F0213_32-V52-plus-E36_Replicate-2_E-coli-Vibrio_S32_L004_R1_001_val_1.fq.gz -2 S_16_F0213_32-V52-plus-E36_Replicate-2_E-coli-Vibrio_S32_L004_R2_001_val_2.fq.gz -S vch_and_e36_VCH_rep_2.sam
bowtie2 -fr -x VCH -q -1 S_16_F0214_33-V52-plus-E36_Replicate-3_E-coli-Vibrio_S33_L004_R1_001_val_1.fq.gz -2 S_16_F0214_33-V52-plus-E36_Replicate-3_E-coli-Vibrio_S33_L004_R2_001_val_2.fq.gz -S vch_and_e36_VCH_rep_3.sam

python htseq-count -f sam -s yes  -t CDS -i ID vch_and_e36_VCH_rep_1.sam VCH_PATRIC.gff > vch_and_e36_VCH_rep_1_counts
python htseq-count -f sam -s yes  -t CDS -i ID vch_and_e36_VCH_rep_2.sam VCH_PATRIC.gff > vch_and_e36_VCH_rep_2_counts
python htseq-count -f sam -s yes  -t CDS -i ID vch_and_e36_VCH_rep_3.sam VCH_PATRIC.gff > vch_and_e36_VCH_rep_3_counts

bowtie2 -fr -x E36 -q -1 S_16_F0212_31-V52-plus-E36_Replicate-1_E-coli-Vibrio_S31_L004_R1_001_val_1.fq.gz -2 S_16_F0212_31-V52-plus-E36_Replicate-1_E-coli-Vibrio_S31_L004_R2_001_val_2.fq.gz -S vch_and_e36_E36_rep_1.sam
bowtie2 -fr -x E36 -q -1 S_16_F0213_32-V52-plus-E36_Replicate-2_E-coli-Vibrio_S32_L004_R1_001_val_1.fq.gz -2 S_16_F0213_32-V52-plus-E36_Replicate-2_E-coli-Vibrio_S32_L004_R2_001_val_2.fq.gz -S vch_and_e36_E36_rep_2.sam
bowtie2 -fr -x E36 -q -1 S_16_F0214_33-V52-plus-E36_Replicate-3_E-coli-Vibrio_S33_L004_R1_001_val_1.fq.gz -2 S_16_F0214_33-V52-plus-E36_Replicate-3_E-coli-Vibrio_S33_L004_R2_001_val_2.fq.gz -S vch_and_e36_E36_rep_3.sam

python htseq-count -f sam -s yes  -t CDS -i ID vch_and_e36_E36_rep_1.sam E36_PATRIC.gff > vch_and_e36_E36_rep_1_counts
python htseq-count -f sam -s yes  -t CDS -i ID vch_and_e36_E36_rep_2.sam E36_PATRIC.gff > vch_and_e36_E36_rep_2_counts
python htseq-count -f sam -s yes  -t CDS -i ID vch_and_e36_E36_rep_3.sam E36_PATRIC.gff > vch_and_e36_E36_rep_3_counts

bowtie2 -fr -x merged_VCH_E36 -q -1 S_16_F0212_31-V52-plus-E36_Replicate-1_E-coli-Vibrio_S31_L004_R1_001_val_1.fq.gz -2 S_16_F0212_31-V52-plus-E36_Replicate-1_E-coli-Vibrio_S31_L004_R2_001_val_2.fq.gz -S vch_and_e36_merged_rep_1.sam
bowtie2 -fr -x merged_VCH_E36 -q -1 S_16_F0213_32-V52-plus-E36_Replicate-2_E-coli-Vibrio_S32_L004_R1_001_val_1.fq.gz -2 S_16_F0213_32-V52-plus-E36_Replicate-2_E-coli-Vibrio_S32_L004_R2_001_val_2.fq.gz -S vch_and_e36_merged_rep_2.sam
bowtie2 -fr -x merged_VCH_E36 -q -1 S_16_F0214_33-V52-plus-E36_Replicate-3_E-coli-Vibrio_S33_L004_R1_001_val_1.fq.gz -2 S_16_F0214_33-V52-plus-E36_Replicate-3_E-coli-Vibrio_S33_L004_R2_001_val_2.fq.gz -S vch_and_e36_merged_rep_3.sam


